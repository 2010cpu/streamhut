(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{3739:function(e,t,n){e.exports=n(3928)},3744:function(e,t,n){},3748:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=3748},3843:function(e,t){},3845:function(e,t){},3879:function(e,t){},3880:function(e,t){},3928:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(34),o=n.n(i),l=(n(3744),n(5)),s=n(6),c=n(8),u=n(7),d=n(9),f=n(145),h=n(29),m=n.n(h),p=n(135),v=n(54),g=n(136),b=n.n(g),y=n(74),E=n(137),w=n.n(E),O=n(138),k=n.n(O),j=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"onClipboardCopy",value:function(e){var t=e.trigger;t.textContent="copied!",t.classList.add("copied"),setTimeout(function(){t.textContent="copy",t.classList.remove("copied")},3e3)}},{key:"render",value:function(){var e=this;return r.a.createElement(k.a,{className:this.props.className||"copy",id:this.props.id,title:"Copy to clipboard","data-clipboard-text":this.props.clipboardText,onSuccess:function(t){return e.onClipboardCopy(t)}},"copy")}}]),t}(a.Component),x=n(139),S=n.n(x),C=n(141),D=n.n(C),F=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(S.a,{className:"help-tooltip",title:this.props.text,"aria-label":this.props.text},r.a.createElement(D.a,{style:this.props.iconStyle}))}}]),t}(a.Component),T=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"max-width-container"},this.props.children)}}]),t}(a.Component),L=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"shareUrlHandler",value:function(e){e.currentTarget.select()}},{key:"onClipboardCopy",value:function(e){var t=e.trigger;t.textContent="copied!",setTimeout(function(){t.textContent="copy"},3e3)}},{key:"render",value:function(){var e=this;return r.a.createElement("header",{id:"header"},r.a.createElement(T,null,r.a.createElement("hgroup",null,r.a.createElement("h1",null,r.a.createElement("img",{src:"/assets/streamhut_bb.png",alt:"Streamhut"})),r.a.createElement("div",{className:"channel"},r.a.createElement("label",null,"Channel URL",r.a.createElement(F,{text:"Share this URL for others to join and see your messages",iconStyle:{fontSize:"1.4em"}})),r.a.createElement("input",{id:"share-url",type:"text",placeholder:"share url",readOnly:!0,value:this.props.shareUrl,onClick:function(t){return e.shareUrlHandler(t)}}),r.a.createElement(j,{clipboardText:this.props.shareUrl})))))}}]),t}(a.Component),_=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={drag:!1},n.dragCounter=0,n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleDrag",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"handleDragIn",value:function(e){e.preventDefault(),e.stopPropagation(),this.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&this.setState({drag:!0})}},{key:"handleDragOut",value:function(e){e.preventDefault(),e.stopPropagation(),this.dragCounter--,0===this.dragCounter&&this.setState({drag:!1})}},{key:"handleDrop",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({drag:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(this.props.handleDrop(e.dataTransfer.files),e.dataTransfer.clearData(),this.dragCounter=0)}},{key:"componentDidMount",value:function(){var e=this,t=document.body;t.addEventListener("dragenter",function(t){return e.handleDragIn(t)}),t.addEventListener("dragleave",function(t){return e.handleDragOut(t)}),t.addEventListener("dragover",function(t){return e.handleDrag(t)}),t.addEventListener("drop",function(t){return e.handleDrop(t)})}},{key:"componentWillUnmount",value:function(){var e=this,t=document.body;t.removeEventListener("dragenter",function(t){return e.handleDragIn(t)}),t.removeEventListener("dragleave",function(t){return e.handleDragOut(t)}),t.removeEventListener("dragover",function(t){return e.handleDrag(t)}),t.removeEventListener("drop",function(t){return e.handleDrop(t)})}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.drag&&r.a.createElement("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:"#000",border:"4px dashed #0075ff",background:"rgba(255, 255, 255, 0.7)"}},r.a.createElement("div",{style:{border:"4px dashed #0075ff",fontSize:"2em",padding:"1em"}},"Drop file here")),this.props.children)}}]),t}(a.Component),N=n(142),U=n.n(N),B=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(U.a,{label:this.props.text,onDelete:this.props.onDelete})}}]),t}(a.Component),I=n(143),M=n.n(I),R=w()("ws://localhost:8765/gun");function q(e){var t=document.createElement("link"),n=document.getElementById("favicon");t.id="favicon",t.rel="icon",t.href=e,n&&document.head.removeChild(n),document.head.appendChild(t)}function A(){document.hidden?(q("/favicon_alert.ico"),document.title="(new message) Streamhut"):z()}function z(){q("/favicon.ico"),document.title="Streamhut"}function P(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(v.a)(m.a.mark(function e(t){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){R.get(t).on(function(t,n){e(t)})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e,t){R.get(e).put(Object(p.a)({},e,t))}document.addEventListener("visibilitychange",function(){document.hidden||z()},!1);var H=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={text:"",file:null,messages:[],shareUrl:window.location.href,fullScreen:!1,queuedFiles:[],fsUrl:""},"f"in window.location.search.substr(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return e[t[0]]=t[1],e},{})&&n.setFullScreen();var a=window.location.pathname,i=window.location.search;return"/"===a&&(window.location.href="/"+M.a.generate({length:3,charset:"alphabetic",capitalization:"lowercase",readable:!0})),n.state.fsUrl="".concat(a).concat(i).concat(i.length?"&":"?","f=1"),n.output=r.a.createRef(),n.fileInput=r.a.createRef(),n.terminalRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"setFullScreen",value:function(){document.body.classList.add("fullscreen")}},{key:"handleInput",value:function(){var e=this,t=this.state.text;if(t){var n=new Blob([t],{type:"text/plain"}),a=new FileReader;a.addEventListener("load",function(t){var n=a.result;e.sendArrayBuffer(n,"text/plain")}),a.readAsArrayBuffer(n),this.setState({text:""})}}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.handleInput(),this.handleFile(),this.setState({text:""})}},{key:"handleFileInputChange",value:function(e){e.preventDefault(),this.addFilesToQueue(e.target.files)}},{key:"handleFile",value:function(){for(var e=this,t=this.state.queuedFiles,n=function(n){var a=t[n];if(console.log("file:",a,a.type),!a)return{v:void 0};var r=new FileReader;r.addEventListener("load",function(t){var n=r.result,i=a.type;e.sendArrayBuffer(n,i)}),r.readAsArrayBuffer(a)},a=0;a<t.length;a++){var r=n(a);if("object"===typeof r)return r.v}this.clearFilesQueue()}},{key:"componentDidMount",value:function(){var e=this;this.ws=function(){var e=window.location,t=e.pathname,n=e.host,a=e.protocol,r="".concat("https:"===a?"wss":"ws","://").concat(n).concat(t),i=new WebSocket(r);return i.binaryType="arraybuffer",i}();document.querySelector("#connections");this.ws.addEventListener("message",function(t){e.handleIncomingMessage(t)}),this.ws.addEventListener("open",function(){console.log("connected")}),this.ws.addEventListener("close",function(){console.log("connection closed")}),this.readCachedMessages()}},{key:"readCachedMessages",value:function(){var e=Object(v.a)(m.a.mark(function e(){var t,n,a,r,i;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.messages,W("messages/count",1),W("messages/1",{data:"1"}),e.next=5,P("messages/count");case 5:if(!(n=e.sent.count)){e.next=18;break}a=0;case 8:if(!(a<n)){e.next=18;break}return r="messages/"+(a+1),console.log(r),e.next=13,P(r);case 13:(i=e.sent)&&console.log("MESSAGE",i);case 15:a++,e.next=8;break;case 18:this.setState({messages:t});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendArrayBuffer",value:function(e,t){var n=Object(y.arrayBufferWithMime)(e,t);this.ws.send(n)}},{key:"handleIncomingMessage",value:function(){var e=Object(v.a)(m.a.mark(function e(t){var n,a,r,i,o,l,s,c,u,d,f,h,p,v=this;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,console.log("incoming..."),e.prev=2,!(a=JSON.parse(n)).__server_message__){e.next=7;break}return this.logMessage(a.__server_message__.data),e.abrupt("return",!1);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:if(A(),document.createDocumentFragment(),console.log(n),r=Object(y.arrayBufferMimeDecouple)(n),i=r.mime,o=r.arrayBuffer,console.log("received",i),console.log(o),"shell"!==i){e.next=23;break}return this.term||(this.term=new window.Terminal({convertEol:!0,scrollback:1e4,disableStdin:!0,cursorBlink:!0}),(l=document.querySelector("#terminal")).style.display="block",this.term.open(l),this.term.fit(),window.addEventListener("resize",function(){v.term.fit()})),s=new window.TextDecoder("utf-8").decode(new Uint8Array(o)),console.log(s),this.term.write(s),e.abrupt("return",!1);case 23:return c=new Blob([o],{type:i}),u=i.split("/").join("_").replace(/[^\w\d_]/gi,""),d=window.URL.createObjectURL(c),e.next=28,new Promise(function(e){var t=new FileReader;t.onload=function(n){e(t.result)},t.readAsText(c)});case 28:f=e.sent,h={blob:c,url:d,ext:u,mime:i,t:f},0!=c.size&&((p=this.state.messages).push(h),this.setState({messages:p})),this.scrollToMessages();case 32:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"scrollToMessages",value:function(){window.scrollTo(0,this.output.current.offsetTop)}},{key:"renderMessage",value:function(e){if(!e)return null;var t=e.mime,n=e.blob,a=e.url,i=e.ext,o=e.t,l=null,s=a;if(/image/gi.test(t))l=r.a.createElement("img",{src:a});else if(/video/gi.test(t))l=[r.a.createElement("div",null,r.a.createElement("video",{src:a,controls:"controls"}))];else if(/audio/gi.test(t))l=[r.a.createElement("audio",{controlers:"controls",src:a})];else if(/zip/gi.test(t))l=[r.a.createElement("span",null,".zip")];else if(/pdf/gi.test(t))l=[r.a.createElement("span",null,".pdf")];else if(/^https?:\/\/[^\s\r\n]+(png|jpe?g|svg)$/i.test(o))s=a=o,l=r.a.createElement("div",null,r.a.createElement("img",{src:a,alt:""}));else{var c=b()(o,{target:"_blank",rel:"noopener noreferrer"});s=c,l=r.a.createElement("code",{dangerouslySetInnerHTML:{__html:c}})}var u="".concat(Date.now(),"_").concat(i);return r.a.createElement("div",{className:"item",key:a},r.a.createElement("header",null,r.a.createElement("span",null,n.type," size: ",n.size,"B"),r.a.createElement("a",{href:a,target:"_blank",rel:"noopenner noreferrer",title:"view asset"},a)),r.a.createElement("article",null,l),r.a.createElement("footer",null,r.a.createElement("div",null,r.a.createElement("a",{href:a,download:u,title:"download asset"},"download"),r.a.createElement(j,{clipboardText:s})),r.a.createElement("time",null,(new Date).toString())))}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&e.shiftKey&&this.handleSubmit(e)}},{key:"handleDrop",value:function(e){this.addFilesToQueue(e)}},{key:"addFilesToQueue",value:function(e){var t=this.state.queuedFiles,n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value;t.push(l)}}catch(s){a=!0,r=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}this.setState({queuedFiles:t})}},{key:"clearFilesQueue",value:function(){this.setState({queuedFiles:[]}),this.fileInput.current.value=""}},{key:"onFileRemove",value:function(e,t){this.removeFileFromQueue(t)}},{key:"removeFileFromQueue",value:function(e){var t=this.state.queuedFiles,n=!0,a=!1,r=void 0;try{for(var i,o=t.entries()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var l=i.value,s=Object(f.a)(l,2),c=s[0];s[1].name===e&&t.splice(c,1)}}catch(u){a=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}this.setState({queuedFiles:t})}},{key:"render",value:function(){var e=this,t=this.state.messages.map(function(t){return e.renderMessage(t)});return r.a.createElement("main",{id:"site-container"},r.a.createElement(L,{shareUrl:this.state.shareUrl}),r.a.createElement("pre",{id:"connections"}),r.a.createElement("div",{style:{position:"relative",with:"500px",maxHeight:"500px"}},r.a.createElement("div",{id:"terminal",ref:this.terminalRef}),r.a.createElement("div",{className:"terminal-footer"},r.a.createElement("a",{href:this.state.fsUrl,className:"link terminal-full-screen",rel:"noopener noreferrer"},"fullscreen"))),r.a.createElement(T,null,r.a.createElement("output",{id:"output",ref:this.output},t),r.a.createElement("form",{id:"form",onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Text ",r.a.createElement("small",null,"shift-enter to submit")),r.a.createElement("textarea",{id:"text",rows:"5",cols:"20",placeholder:"text",value:this.state.text,onKeyPress:function(t){return e.handleKeyPress(t)},onChange:function(t){return e.setState({text:t.target.value})}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Files ",r.a.createElement("small",null,"Drag files into screen")),r.a.createElement("div",{style:{marginBottom:"0.5em"}},r.a.createElement("input",{type:"file",multiple:!0,id:"file",onChange:function(t){return e.handleFileInputChange(t)},ref:this.fileInput})),r.a.createElement("div",{className:"queued-files"},this.state.queuedFiles.map(function(t){return r.a.createElement(B,{className:"file-tag",key:t.name,text:t.name,onDelete:function(n){return e.onFileRemove(n,t.name)}})}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"Submit"))))),r.a.createElement(_,{handleDrop:function(t){return e.handleDrop(t)}}))}}]),t}(a.Component),K=n(75),G=n(144),J=n.n(G),$=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=J()().year();return r.a.createElement("footer",{id:"footer"},r.a.createElement(T,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"copyright"},"\xa9 ",e," ",r.a.createElement("img",{src:"/assets/streamhut_gray.png",alt:"Streamhut"})),r.a.createElement("div",{className:"social"},r.a.createElement("a",{href:"https://github.com/streamhut",target:"_blank",rel:"noopener noreferrer",title:"Github @streamhut"},r.a.createElement(K.a,null),"Github"),r.a.createElement("a",{href:"https://twitter.com/streamhut",target:"_blank",rel:"noopener noreferrer",title:"Twitter @streamhut"},r.a.createElement(K.b,null),"Twitter")))))}}]),t}(a.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return[this.props.children,r.a.createElement($,null)]}}]),t}(a.Component),X=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(V,null,r.a.createElement(H,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[3739,1,2]]]);
//# sourceMappingURL=main.86743c50.chunk.js.map